
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Total magnetization estimation methods (fatiando.gravmag.magdir) &mdash; fatiando 0.4 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '429a4e7de0857f3152fc8af6024d675dd9cf69cb',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="fatiando 0.4 documentation" href="../index.html" />
    <link rel="up" title="Gravity and magnetics (fatiando.gravmag)" href="gravmag.html" />
    <link rel="next" title="Compute normal gravity and reductions (fatiando.gravmag.normal_gravity)" href="gravmag.normal_gravity.html" />
    <link rel="prev" title="Forward modeling of half a spherical shell (fatiando.gravmag.half_sph_shell)" href="gravmag.half_sph_shell.html" />
    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-38125837-1', 'auto');
    ga('send', 'pageview');
    </script>

  </head>
  <body role="document">




  <div id="navbar" class="navbar navbar-default navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/fatiando-logo.png">
          fatiando</a>
        <span class="navbar-text navbar-version pull-left"><b>0.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../install.html">Installing</a></li>
                <li><a href="../docs.html">Documentation</a></li>
                <li><a href="../cookbook.html">Cookbook</a></li>
                <li><a href="../develop.html">Developer Guide</a></li>
                <li><a href="https://github.com/fatiando/fatiando"><i class="fa fa-github-square fa-lg" title="Source code on Github"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="module-fatiando.gravmag.magdir">
<span id="total-magnetization-estimation-methods-fatiando-gravmag-magdir"></span><span id="fatiando-gravmag-magdir"></span><h1>Total magnetization estimation methods (<code class="docutils literal"><span class="pre">fatiando.gravmag.magdir</span></code>)<a class="headerlink" href="#module-fatiando.gravmag.magdir" title="Permalink to this headline">¶</a></h1>
<p>Estimation of the total magnetization vector of homogeneous bodies.</p>
<p>It estimates parameters related to the magnetization vector of homogeneous
bodies.</p>
<p><strong>Algorithms</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#fatiando.gravmag.magdir.DipoleMagDir" title="fatiando.gravmag.magdir.DipoleMagDir"><code class="xref py py-class docutils literal"><span class="pre">DipoleMagDir</span></code></a>: This class estimates
the Cartesian components of the magnetization vector of homogeneous
dipolar bodies with known center. The estimated magnetization vector
is converted to dipole moment, inclination (positive down) and declination
(with respect to x, North).</li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="fatiando.gravmag.magdir.DipoleMagDir">
<em class="property">class </em><code class="descclassname">fatiando.gravmag.magdir.</code><code class="descname">DipoleMagDir</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>data</em>, <em>inc</em>, <em>dec</em>, <em>points</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/magdir.html#DipoleMagDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.misfit.html#fatiando.inversion.misfit.Misfit" title="fatiando.inversion.misfit.Misfit"><code class="xref py py-class docutils literal"><span class="pre">fatiando.inversion.misfit.Misfit</span></code></a></p>
<p>Estimate the magnetization vector of a set of dipoles from magnetic
total field anomaly.</p>
<p>By using the well-known first-order approximation of the total field
anomaly (Blakely, 1996, p. 179) produced by a set of dipoles, the
estimation of the Cartesian components of the magnetization vectors is
formulated as linear inverse problem. After estimating the magnetization
vectors, they are converted to dipole moment, inclination (positive down)
and declination (with respect to x, North).</p>
<p>After solving, use the <code class="docutils literal"><span class="pre">estimate_</span></code> attribute to get the estimated
magnetization vectors in dipole moment, inclination and declination.  The
estimated magnetization vectors in Cartesian coordinates can be accessed
through the <code class="docutils literal"><span class="pre">p_</span></code> attribute.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assumes x = North, y = East, z = Down.</p>
</div>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>x, y, z <span class="classifier-delimiter">:</span> <span class="classifier">1d-arrays</span></dt>
<dd><p class="first last">The x, y, z coordinates of each data point.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd><p class="first last">The total field magnetic anomaly data at each point.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>inc, dec <span class="classifier-delimiter">:</span> <span class="classifier">floats</span></dt>
<dd><p class="first last">The inclination and declination of the inducing field</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier">list of points [x, y, z]</span></dt>
<dd><p class="first last">Each point [x, y, z] is the center of a dipole. Will invert for
the Cartesian components of the magnetization vector of each
dipole. Subsequently, the estimated magnetization vectors are
converted to dipole moment, inclination and declination.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Inclination is positive down and declination is measured with
respect to x (North).</p>
</div>
<p>References:</p>
<p>Blakely, R. (1996), Potential theory in gravity and magnetic applications:
CUP</p>
<p>Examples:</p>
<p>Estimation of the total magnetization vector of dipoles with known centers</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fatiando</span> <span class="kn">import</span> <span class="n">gridder</span><span class="p">,</span> <span class="n">utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fatiando.gravmag</span> <span class="kn">import</span> <span class="n">sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fatiando.mesher</span> <span class="kn">import</span> <span class="n">Sphere</span><span class="p">,</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Produce some synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">gridder</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mi">150</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="n">Sphere</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>             <span class="p">{</span><span class="s">&#39;magnetization&#39;</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ang2vec</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">)}),</span>
<span class="gp">... </span>         <span class="n">Sphere</span><span class="p">(</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>             <span class="p">{</span><span class="s">&#39;magnetization&#39;</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ang2vec</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.0</span><span class="p">)})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inc</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tf</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">tf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Give the coordinates of the dipoles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3000.0</span><span class="p">,</span> <span class="mf">3000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">7000.0</span><span class="p">,</span> <span class="mf">7000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">ang2vec</span><span class="p">(</span><span class="n">CM</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="mf">6.0</span><span class="o">*</span><span class="mi">1000</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                                            <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="n">ang2vec</span><span class="p">(</span><span class="n">CM</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="mf">6.0</span><span class="o">*</span><span class="mi">1000</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                                             <span class="mf">30.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">40.0</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimate_true</span> <span class="o">=</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">vec2ang</span><span class="p">(</span><span class="n">p_true</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span>
<span class="gp">... </span>                               <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Make a solver and fit it to the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">DipoleMagDir</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check the fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">predicted</span><span class="p">(),</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># solver.p_ returns the Cartesian components of the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># estimated magnetization vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">solver</span><span class="o">.</span><span class="n">p_</span><span class="p">:</span> <span class="k">print</span> <span class="s">&quot;</span><span class="si">%.10f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">p</span>
<span class="go">2325.8255393651</span>
<span class="go">-410.1057950109</span>
<span class="go">-859.5903757213</span>
<span class="go">1667.3411086852</span>
<span class="go">-1399.0653093445</span>
<span class="go">1256.6370614359</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check the estimated parameter vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">p_true</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">p_</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># The parameter vector is not that useful so use solver.estimate_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># to convert the estimated magnetization vectors in dipole moment,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># inclination and declination.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">solver</span><span class="o">.</span><span class="n">estimate_</span><span class="p">:</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="s">&quot;</span><span class="si">%.10f</span><span class="s"> </span><span class="si">%.10f</span><span class="s"> </span><span class="si">%.10f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">2513.2741228718 -20.0000000000 -10.0000000000</span>
<span class="go">2513.2741228718 30.0000000000 -40.0000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check the converted estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">estimate_true</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">estimate_</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">atol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.config">
<code class="descname">config</code><span class="sig-paren">(</span><em>method</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the optimization method and its parameters.</p>
<p>This sets the method used by
<code class="xref py py-meth docutils literal"><span class="pre">fit</span></code> and the keyword
arguments that are passed to it.</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>method <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">The optimization method. One of: <code class="docutils literal"><span class="pre">'linear'</span></code>, <code class="docutils literal"><span class="pre">'newton'</span></code>,
<code class="docutils literal"><span class="pre">'levmarq'</span></code>, <code class="docutils literal"><span class="pre">'steepest'</span></code>, <code class="docutils literal"><span class="pre">'acor'</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>Other keyword arguments that can be passed are the ones allowed by each
method.</p>
<p>Some methods have required arguments:</p>
<ul class="simple">
<li><em>newton</em>, <em>levmarq</em> and <em>steepest</em> require the <code class="docutils literal"><span class="pre">initial</span></code> argument
(an initial estimate for the gradient descent)</li>
<li><em>acor</em> requires the <code class="docutils literal"><span class="pre">bounds</span></code> argument (min/max values for the
search space)</li>
</ul>
<p>See the corresponding docstrings for more information:</p>
<ul class="simple">
<li><a class="reference internal" href="inversion.optimization.html#fatiando.inversion.optimization.linear" title="fatiando.inversion.optimization.linear"><code class="xref py py-meth docutils literal"><span class="pre">linear</span></code></a></li>
<li><a class="reference internal" href="inversion.optimization.html#fatiando.inversion.optimization.newton" title="fatiando.inversion.optimization.newton"><code class="xref py py-meth docutils literal"><span class="pre">newton</span></code></a></li>
<li><a class="reference internal" href="inversion.optimization.html#fatiando.inversion.optimization.levmarq" title="fatiando.inversion.optimization.levmarq"><code class="xref py py-meth docutils literal"><span class="pre">levmarq</span></code></a></li>
<li><a class="reference internal" href="inversion.optimization.html#fatiando.inversion.optimization.steepest" title="fatiando.inversion.optimization.steepest"><code class="xref py py-meth docutils literal"><span class="pre">steepest</span></code></a></li>
<li><a class="reference internal" href="inversion.optimization.html#fatiando.inversion.optimization.acor" title="fatiando.inversion.optimization.acor"><code class="xref py py-meth docutils literal"><span class="pre">acor</span></code></a></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>deep=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of me together with all the cached methods.</p>
</dd></dl>

<dl class="attribute">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.estimate_">
<code class="descname">estimate_</code><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.estimate_" title="Permalink to this definition">¶</a></dt>
<dd><p>A nicely formatted version of the estimate.</p>
<p>If the class implements a <cite>fmt_estimate</cite> method, this will its results.
This can be used to convert the parameter vector to a more useful form,
like a <a class="reference internal" href="mesher.html#module-fatiando.mesher" title="fatiando.mesher"><code class="xref py py-mod docutils literal"><span class="pre">fatiando.mesher</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve for the parameter vector that minimizes this objective function.</p>
<p>Uses the optimization method and parameters defined using the
<a class="reference internal" href="inversion.base.html#fatiando.inversion.base.OptimizerMixin.config" title="fatiando.inversion.base.OptimizerMixin.config"><code class="xref py py-meth docutils literal"><span class="pre">config</span></code></a> method.</p>
<p>The estimated parameter vector can be accessed through the
<code class="docutils literal"><span class="pre">p_</span></code> attribute. A (possibly) formatted version (converted to a more
manageable type) of the estimate can be accessed through the property
<code class="docutils literal"><span class="pre">estimate_</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.fmt_estimate">
<code class="descname">fmt_estimate</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/magdir.html#DipoleMagDir.fmt_estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.fmt_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the estimate parameters from Cartesian to inclination,
declication, and intensity.</p>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.gradient">
<code class="descname">gradient</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>The gradient vector of the misfit function.</p>
<div class="math">
\[\bar{g} = -2\bar{\bar{J}}^T\bar{r}\]</div>
<p>where <span class="math">\(\bar{\bar{J}}\)</span> is the Jacobian matrix and <span class="math">\(\bar{r}\)</span>
is the residual vector.</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>p <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd><p class="first last">The parameter vector where the gradient is evaluated</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><dl class="first docutils">
<dt>gradient <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd><p class="first last">The gradient vector.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.hessian">
<code class="descname">hessian</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hessian of the misfit function with respect to the parameters.</p>
<p>Calculated using the Gauss approximation:</p>
<div class="math">
\[\bar{\bar{H}} \approx 2\bar{\bar{J}}^T\bar{\bar{J}}\]</div>
<p>where <span class="math">\(\bar{\bar{J}}\)</span> is the Jacobian matrix.</p>
<p>For linear problems, the Hessian matrix is cached in memory, so calling
this method again will not trigger a re-calculation.</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>p <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd><p class="first last">The parameter vector where the Hessian is evaluated</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><dl class="first docutils">
<dt>hessian <span class="classifier-delimiter">:</span> <span class="classifier">2d-array</span></dt>
<dd><p class="first last">The Hessian matrix</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.regul_param">
<code class="descname">regul_param</code><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.regul_param" title="Permalink to this definition">¶</a></dt>
<dd><p>The regularization parameter (scale factor) for the objetive function.</p>
<p>Defaults to 1.</p>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.residuals">
<code class="descname">residuals</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the residuals vector (observed - predicted data).</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>p <span class="classifier-delimiter">:</span> <span class="classifier">1d-array or None</span></dt>
<dd><p class="first last">The parameter vector used to calculate the residuals. If None, will
use the current estimate stored in <code class="docutils literal"><span class="pre">estimate_</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><dl class="first docutils">
<dt>residuals <span class="classifier-delimiter">:</span> <span class="classifier">1d-array or list of 1d-arrays</span></dt>
<dd><p class="first last">The residual vector. If this is the sum of 1 or more Misfit
instances, will return the residual vector from each of the summed
misfits in the order of the sum.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.set_weights">
<code class="descname">set_weights</code><span class="sig-paren">(</span><em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.set_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the data weights.</p>
<p>Using weights for the data, the least-squares data-misfit function
becomes:</p>
<div class="math">
\[\phi = \bar{r}^T \bar{\bar{W}}\bar{r}\]</div>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>weights <span class="classifier-delimiter">:</span> <span class="classifier">1d-array or 2d-array or None</span></dt>
<dd><p class="first last">Weights for the data vector.
If None, will remove any weights that have been set before.
If it is a 2d-array, it will be interpreted as the weight matrix
<span class="math">\(\bar{\bar{W}}\)</span>.
If it is a 1d-array, it will be interpreted as the diagonal of the
weight matrix (all off-diagonal elements will default to zero).
The weight matrix can be a sparse array from <code class="docutils literal"><span class="pre">scipy.sparse</span></code>.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="fatiando.gravmag.magdir.DipoleMagDir.value">
<code class="descname">value</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#fatiando.gravmag.magdir.DipoleMagDir.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the value of the misfit for a given parameter vector.</p>
<p>The value is given by:</p>
<div class="math">
\[\phi(\bar{p}) = \bar{r}^T\bar{\bar{W}}\bar{r}\]</div>
<p>where <span class="math">\(\bar{r}\)</span> is the residual vector and <span class="math">\(bar{\bar{W}}\)</span>
are optional data weights.</p>
<p>Parameters:</p>
<ul>
<li><dl class="first docutils">
<dt>p <span class="classifier-delimiter">:</span> <span class="classifier">1d-array or None</span></dt>
<dd><p class="first last">The parameter vector.</p>
</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul>
<li><dl class="first docutils">
<dt>value <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The value of the misfit function.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
    <div class="container">
        <p class="pull-right">
            <a href="#">Back to top</a>
            
                <br/>
                
<div id="sourcelink">
  <a href="../_sources/api/gravmag.magdir.txt"
     rel="nofollow">Source</a>
</div>
            
        </p>

        <p class="text-center">
            &copy; Copyright 2010-2016, Leonardo Uieda.
            Created using <a
                href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
        </p>
    </div>
</footer>
  </body>
</html>